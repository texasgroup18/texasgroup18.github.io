<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Finance</title>
  <link rel="stylesheet" href="style.css"/>
  <style>
    .back-btn {
      background: #0077cc;
      color: white;
      padding: 8px 16px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: bold;
      transition: background 0.3s ease;
    }
    .back-btn:hover {
      background: #005fa3;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 40px;
      background: #f8f9fa;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    header h1 {
      margin: 0;
    }
    .header-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .logo {
      height: 40px;
      border-radius: 50%;
    }
  </style>
</head>
<body>

  <!-- Header -->
  <header>
    <div class="header-left">
      <img src="images/logo.JPG" alt="Texas Group Logo" class="logo" />
      <h1>Finance</h1>
    </div>
    <div class="header-right">
      <a href="index.html" class="back-btn">Back to Home</a>
    </div>
  </header>

  <!-- Hero Section -->
  <section class="hero">
    <div class="hero-content">
      <h2>Group Finance Overview</h2>
      <p>Track contributions, expenses, fines and remaining balance</p>
    </div>
  </section>

  <!-- Password Section -->
  <section id="password-section" class="section">
    <div class="container">
      <h2>Enter Password to View Finance Data</h2>
      <input type="password" id="passwordInput" placeholder="Enter Password"/>
      <button onclick="checkPassword()">Submit</button>
      <p id="error-message" style="color:red; display:none;">Incorrect password!</p>
    </div>
  </section>

  <!-- Finance Section -->
  <main id="finance-content" style="display:none;">
    <section class="section">
      <div class="container">
        <h2>Finance Overview</h2>
        <div class="cards">
          <div class="card">
            <h3>Total Contributions</h3>
            <p id="total-contribution">Loading...</p>
          </div>
          <div class="card">
            <h3>Total Fines</h3>
            <p id="total-fines">Loading...</p>
          </div>
          <div class="card">
            <h3>Total Expenses</h3>
            <p id="total-expenses">Loading...</p>
          </div>
          <div class="card">
            <h3>Remaining Balance</h3>
            <p id="remaining-amount">Loading...</p>
          </div>
        </div>
      </div>
    </section>

    <section class="section">
      <div class="container">
        <h2>Contributions</h2>
        <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS_rdpztfVyLrlPgSWmNIuGhLeo-g4n9Pw4Zdz0gz92pIXA9eaowq-d-g9GywvK8TlpZ1ET47i8czE8/pubhtml?gid=2096610384&single=true" width="100%" height="400"></iframe>
      </div>
    </section>

    <section class="section">
      <div class="container">
        <h2>Fines</h2>
        <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS_rdpztfVyLrlPgSWmNIuGhLeo-g4n9Pw4Zdz0gz92pIXA9eaowq-d-g9GywvK8TlpZ1ET47i8czE8/pubhtml?gid=0&single=true" width="100%" height="200"></iframe>
      </div>
    </section>

    <section class="section">
      <div class="container">
        <h2>Expenses</h2>
        <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS_rdpztfVyLrlPgSWmNIuGhLeo-g4n9Pw4Zdz0gz92pIXA9eaowq-d-g9GywvK8TlpZ1ET47i8czE8/pubhtml?gid=715722052&single=true" width="100%" height="400"></iframe>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <p>ðŸ“§ Email: texasgroup18@gmail.com | ðŸ“ž Contact: 8856967466</p>
    <p>&copy; 2025 Texas Group. All Rights Reserved.</p>
  </footer>

  <script>
    const PASSWORD = "Texas18";

    function checkPassword() {
      const input = document.getElementById("passwordInput").value;
      if (input === PASSWORD) {
        document.getElementById("password-section").style.display = "none";
        document.getElementById("finance-content").style.display = "block";
      } else {
        document.getElementById("error-message").style.display = "block";
      }
    }

    // Totals Calculation
    async function fetchTotals() {
      try {
        let contributionRes = await fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vS_rdpztfVyLrlPgSWmNIuGhLeo-g4n9Pw4Zdz0gz92pIXA9eaowq-d-g9GywvK8TlpZ1ET47i8czE8/pub?gid=2096610384&single=true&output=csv");
        let expenseRes = await fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vS_rdpztfVyLrlPgSWmNIuGhLeo-g4n9Pw4Zdz0gz92pIXA9eaowq-d-g9GywvK8TlpZ1ET47i8czE8/pub?gid=715722052&single=true&output=csv");
        let finesRes = await fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vS_rdpztfVyLrlPgSWmNIuGhLeo-g4n9Pw4Zdz0gz92pIXA9eaowq-d-g9GywvK8TlpZ1ET47i8czE8/pub?gid=0&single=true&output=csv");

        let contributionText = await contributionRes.text();
        let expenseText = await expenseRes.text();
        let finesText = await finesRes.text();

        let contributionTotal = sumCSV(contributionText);
        let expenseTotal = sumCSV(expenseText);
        let finesTotal = sumCSV(finesText);

        let remaining = (contributionTotal + finesTotal) - expenseTotal;

        document.getElementById("total-contribution").innerText = "â‚¹" + contributionTotal.toLocaleString();
        document.getElementById("total-expenses").innerText = "â‚¹" + expenseTotal.toLocaleString();
        document.getElementById("total-fines").innerText = "â‚¹" + finesTotal.toLocaleString();
        document.getElementById("remaining-amount").innerText = "â‚¹" + remaining.toLocaleString();
      } catch (e) {
        console.error("Error fetching totals", e);
      }
    }

    function sumCSV(csvText) {
      let rows = csvText.split("\n").slice(1);
      let sum = 0;
      rows.forEach(row => {
        let cols = row.split(",");
        let value = parseFloat(cols[cols.length - 1]);
        if (!isNaN(value)) sum += value;
      });
      return sum;
    }

    fetchTotals();
  </script>
</body>
</html>